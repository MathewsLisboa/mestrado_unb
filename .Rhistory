mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- 0
if(n<90){
bin <- 30
}else if(n>90 & n<180){
bin <- 15
}else{
bin <- 5
}
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- 0
if(n<90){
bin <- 30
}else if(n>=90 & n<180){
bin <- 15
}else{
bin <- 5
}
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
library(tidyverse)
library(readr)
library(lubridate)
library(stringr)
source("BGEV_functions.R")
### Leitura dos dados originais
df <- readRDS('D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb/dados_resumidos/dados_originais.rds')
df <- readRDS('dados_resumidos/dados_originais.rds')
library(tidyverse)
library(readr)
library(lubridate)
library(stringr)
source("BGEV_functions.R")
library(tidyverse)
library(readr)
library(lubridate)
library(stringr)
source("BGEV_functions.R")
### Leitura dos dados originais
df <- readRDS('dados_resumidos/dados_originais.rds')
### criação dos dados por média de tempo de orvalho
temp_media <- df  %>% group_by(Data) %>% summarise(media_temp = mean(TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm = T))
### bloco minimos, definindop tamanho do bloco
hist(temp_media$media_temp , main = 'Dados diários sem bloco', probability = T)
lines(density(temp_media$media_temp))
plot(temp_media$media_temp, type = 'l')
acf(temp_media$media_temp)
N <- length(temp_media$media_temp)
High <- temp_media$media_temp
result <- data.frame()
for (k in 1:100) {
n<-k
tau<-floor(N/n)
m<-numeric(tau) ; j<-1
for (i in 1:tau){
m[i]<-max(High[j:(j+n-1)])
j<-j+n }
m<-m[-1]
teste<-Box.test(m, lag = 1,
type = c("Box-Pierce", "Ljung-Box"),
fitdf = 0)
teste$indice <- k
teste <- c(teste$indice,teste$p.value)
result <- rbind(result, teste)
}
result <- tibble(result)
names(result) <- c("Tamanho do bloco","P-valor (teste de Ljung-Box)")
### histogramas para diversos tamanhos de blocos minimos de fato
fns <- c(15,30,60,90,120,150,180,360)
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- 0
if(n<90){
bin <- 30
}else if(n>=90 & n<180){
bin <- 15
}else{
bin <- 5
}
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='min',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
mean(temp_min_orvalho)
median(temp_min_orvalho)
sd(temp_min_orvalho)
min(temp_min_orvalho)
max(temp_min_orvalho)
mean(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
sd(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
median(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
quantile(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
max(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
min(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
## Temperatura média ponto do orvalho tirando mínimo####
## vou trabalhar com ela nesse código e espero conseguir inclusive um bom ajuste do modelo ##
source("BGEV_functions.R")
### Primeiros analisamos
temp_min_orvalho <- readRDS("D://Users/Mathews/Documents/Git/mestrado_unb/dados_resumidos/temperatura_min_orvalho.rds")
mean(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
sd(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
median(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
quantile(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
max(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
min(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
mean(temp_media$media_temp)
sd(temp_media$media_temp)
median(temp_media$media_temp)
max(temp_media$media_temp)
min(temp_media$media_temp)
starts <- c(mu=fit@fit$par.ests[2],sigma=fit@fit$par.ests[3], xi=fit@fit$par.ests[1], delta=0)
starts
test <- optim(par=starts,fn=likbgev,y=Z2,method = 'BFGS',hessian = T)
test
starts
test$par
test$hessian
sqrt(diag(solve(test$hessian)))
source("BGEV_functions.R")
### Primeiros analisamos
temp_min_orvalho <- readRDS("D://Users/Mathews/Documents/Git/mestrado_unb/dados_resumidos/temperatura_min_orvalho.rds")
mean(temp_media$media_temp)
sd(temp_media$media_temp)
median(temp_media$media_temp)
max(temp_media$media_temp)
min(temp_media$media_temp)
## Temperatura média ponto do orvalho tirando mínimo####
## vou trabalhar com ela nesse código e espero conseguir inclusive um bom ajuste do modelo ##
source("BGEV_functions.R")
temp_min_orvalho <- readRDS("dados_resumidos/temperatura_min_orvalho.rds")
temp_media <- readRDS("dados_resumidos/temp_media_diaria.rds")
mean(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
sd(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
median(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
quantile(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
max(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
min(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
mean(temp_media$media_temp)
sd(temp_media$media_temp)
median(temp_media$media_temp)
max(temp_media$media_temp)
min(temp_media$media_temp)
library(cowplot)
acf(temp_media$media_temp, main="")
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
H1 <- ggplot(df,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
H1
mean(temp_min_orvalho)
median(temp_min_orvalho)
sd(temp_min_orvalho)
min(temp_min_orvalho)
max(temp_min_orvalho)
a <- df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.[is.na(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.)==F]
acf(a, main='')
acf(temp_media$media_temp, main='')
library(timeSeries)
st <- ts(temp_min_orvalho)
acf(temp_min_orvalho, main='')
temp_min <- data.frame(x = temp_min_orvalho)
ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
Z2 <- temp_min_orvalho
fit <- fExtremes::gevFit(Z2, type = 'mle')
fit
starts <- c(mu=fit@fit$par.ests[2],sigma=fit@fit$par.ests[3], xi=fit@fit$par.ests[1], delta=0)
fit <- fExtremes::gevFit(Z2, type = 'mle')
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
library(tidyverse)
library(ggplot2)
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
library(cowplot)
library(tidyverse)
library(ggplot2)
library(evd)
library(cowplot)
library(tidyverse)
library(ggplot2)
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
H1 <- ggplot(df,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
H1
H1 <- ggplot(df,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
ggplot(df,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
temp_min_orvalho <- readRDS("dados_resumidos/temperatura_min_orvalho.rds")
temp_media <- readRDS("dados_resumidos/temp_media_diaria.rds")
mean(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
sd(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
median(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
quantile(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
max(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
min(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C., na.rm=T)
temp_min_orvalho <- readRDS("dados_resumidos/temperatura_min_orvalho.rds")
temp_media <- readRDS("dados_resumidos/temp_media_diaria.rds")
mean(temp_media$media_temp)
sd(temp_media$media_temp)
median(temp_media$media_temp)
max(temp_media$media_temp)
min(temp_media$media_temp)
ggplot(df,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
temp_media
ggplot(temp_min_orvalho,aes(x=TEMPERATURA.DO.PONTO.DE.ORVALHO...C.))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
mean(temp_min_orvalho)
median(temp_min_orvalho)
sd(temp_min_orvalho)
min(temp_min_orvalho)
max(temp_min_orvalho)
a <- df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.[is.na(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.)==F]
acf(a, main='')
acf(temp_media$media_temp, main='')
temp_min <- data.frame(x = temp_min_orvalho)
ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
Z2 <- temp_min_orvalho
fit <- fExtremes::gevFit(Z2, type = 'mle')
starts <- c(mu=fit@fit$par.ests[2],sigma=fit@fit$par.ests[3], xi=fit@fit$par.ests[1], delta=0)
test <- optim(par=starts,fn=likbgev,y=Z2,method = 'BFGS',hessian = T)
fit@fit$par.ests[2]
fit@fit$par.ses
sqrt(diag(fit@fit$varcov))
test$par
test$hessian
sqrt(diag(solve(test$hessian)))
#### Gráfico Bilateral ######
colors <- c('BGEV'='black', 'GEV'='red')
ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
geom_line(aes(x=x,y=dbgevd(x, mu=test$par[1],sigma=test$par[2],
xi = test$par[3], delta= test$par[4]), color='BGEV'),size=1)+
##PorLegenda
geom_line(aes(x=x,y=dgev(x, loc=fit@fit$par.ests[2], scale = fit@fit$par.ests[3], shape = fit@fit$par.ests[1]), color='GEV'),size=1)+
labs(x='min',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
H2
nrow(df)
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggplot(temp_media,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
temp_media
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,25,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggplot(temp_media,aes(x=media_temp))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,24,1))+
labs(x='x',y='')+
#labs(y='Densidade',x='Temp. Orvalho média diária')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black')
)
temp_min_orvalho <- readRDS("dados_resumidos/temperatura_min_orvalho.rds")
mean(temp_media$media_temp)
sd(temp_media$media_temp)
median(temp_media$media_temp)
max(temp_media$media_temp)
min(temp_media$media_temp)
temp_min_orvalho <- readRDS("dados_resumidos/temperatura_min_orvalho.rds")
temp_min_orvalho
temp_min <- data.frame(x = temp_min_orvalho)
temp_min
IID$par
library(cowplot)
library(tidyverse)
library(ggplot2)
library(evd)
fit@fit$par.ests[2]
fit@fit$par.ses
sqrt(diag(fit@fit$varcov))
