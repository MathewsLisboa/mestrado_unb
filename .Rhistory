panel.border=element_blank(),
axis.line=element_line(colour='black'))
mean(temp_min_orvalho)
median(temp_min_orvalho)
sd(temp_min_orvalho)
min(temp_min_orvalho)
max(temp_min_orvalho)
a <- df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.[is.na(df$TEMPERATURA.DO.PONTO.DE.ORVALHO...C.)==F]
acf(a, main='')
acf(temp_media$media_temp, main='')
library(timeSeries)
st <- ts(temp_min_orvalho)
acf(temp_min_orvalho, main='')
temp_min <- data.frame(x = temp_min_orvalho)
ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
labs(x='x',y='')+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'))
Z2 <- temp_min_orvalho
fit <- fExtremes::gevFit(Z2, type = 'mle')
starts <- c(mu=fit@fit$par.ests[2],sigma=fit@fit$par.ests[3], xi=fit@fit$par.ests[1], delta=0)
test <- optim(par=starts,fn=likbgev,y=Z2,method = 'BFGS',hessian = T)
fit@fit$par.ests[2]
fit@fit$par.ses
sqrt(diag(fit@fit$varcov))
test$par
test$hessian
sqrt(diag(solve(test$hessian)))
#### GrÃ¡fico Bilateral ######
colors <- c('BGEV'='black', 'GEV'='red')
H2 <- ggplot(temp_min,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',breaks=seq(0,21,1))+
geom_line(aes(x=x,y=dbgevd(x, mu=test$par[1],sigma=test$par[2],
xi = test$par[3], delta= test$par[4]), color='BGEV'),size=1)+
##PorLegenda
geom_line(aes(x=x,y=dgev(x, loc=fit@fit$par.ests[2], scale = fit@fit$par.ests[3], shape = fit@fit$par.ests[1]), color='GEV'),size=1)+
labs(x='min',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
H2
x
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(x),
color='GEV'),size=1)
density(mi)
lines(density(mi))
density(mi)
density(mi)
d <- density(mi)
d$y
density(mi)$y
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(x)$y,
color='GEV'),size=1)
density(x)$y
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(mi)$y,
color='GEV'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')
ggplot(df,aes(x=x))+
#geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(mi)$y,
color='GEV'),size=1)
ggplot(df,aes(x=x))+
#geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(mi)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(mi)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(x=x,y=density(x)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(y=density(x)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(y=density(x)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
##PorLegenda
geom_line(aes(y=density(mi)$y,
color='red'),size=1)
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
geom_density(lwd=1.2,
linetype = 1,
colour = 'red')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
geom_density(lwd=1,
linetype = 1,
colour = 'red')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
n<-15
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
geom_density(lwd=1,
linetype = 1,
colour = 'red')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
fns <- c(15,30,60,90,120,150,180,360)
fns[1]
fns <- c(15,30,60,90,120,150,180,360)
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969')+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
mi
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = 30)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
n<-fns[1]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
nrow(df)
nrow(df)/15
fns <- c(15,30,60,90,120,150,180,360)
for( i in 1:length(fns)) {
n<-fns[1]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = nrow(df)/n)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = nrow(df)/n)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = nrow(df)/10)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
fns <- c(15,30,60,90,120,150,180,360)
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- ifelse(n<90,30,10)
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- ifelse(n<=90,30,10)
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- 0
if(n<90){
bin <- 30
}else if(n>90 & n<180){
bin <- 15
}else{
bin <- 5
}
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
for( i in 1:length(fns)) {
n<-fns[i]
N<-length(HIGH)
HIGH <- temp_media$media_temp
N<-length(HIGH)  ;
tau<-floor(N/n)
mi<-numeric(tau) ; j<-1
for (i in 1:tau){
mi[i]<-min(HIGH[j:(j+n-1)])
j<-j+n }
hist(mi, probability = T)
lines(density(mi))
bin <- 0
if(n<90){
bin <- 30
}else if(n>=90 & n<180){
bin <- 15
}else{
bin <- 5
}
df <- data.frame(x=mi)
#temp_min_orvalho <- mi
# saveRDS(mi, file = 'D:\\Users\\Mathews\\Documents\\Git\\mestrado_unb\\dados_resumidos\\temperatura_min_orvalho.rds')
ggplot(df,aes(x=x))+
geom_histogram(aes(y = ..density..),colour='white',fill='#696969',bins = bin)+
geom_density(lwd=1,
linetype = 1,
colour = 'black')+
labs(x='m',y='', color='')+
scale_color_manual(values=colors)+
theme_bw()+
theme(axis.title.y=element_text(colour='black',size=12),
axis.title.x=element_text(colour='black',size=12),
axis.text=element_text(colour='black',size=9.5),
panel.border=element_blank(),
axis.line=element_line(colour='black'),
legend.position = 'top')
ggsave(paste0('imagens_artigo\\histogramas_cira\\fn',n,'.png'),
width=158,height=93,units='mm')
}
